{% extends 'base.html' %}

{% block title %}إحصائيات المنتجات{% endblock %}

{% block extra_css %}
<style>
  .content-card {
    background: #fff;
    max-width: 900px;
    margin: 2rem auto;
    padding: 2rem;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    direction: rtl;
    text-align: right;
  }
  .page-title {
    font-size: 1.75rem;
    margin-bottom: .5rem;
    color: #222;
  }
  .subtitle {
    font-size: 1rem;
    color: #555;
    margin-bottom: 1.5rem;
  }
  .stats-summary {
    display: flex;
    gap: 1rem;
    margin-bottom: 1.5rem;
  }
  .stats-summary .item {
    flex: 1;
    background: #f5f5f5;
    padding: 1rem;
    border-radius: 6px;
    text-align: center;
  }
  .stats-summary .item h3 {
    margin-bottom: .5rem;
    color: #333;
    font-size: 1.1rem;
    font-weight: 600;
  }
  .stats-summary .item p {
    margin:0;
    font-size: 1.5rem;
    font-weight: 600;
    color: #667eea;
  }
  .table-container { overflow-x: auto; }
  table {
    width: 100%;
    border-collapse: collapse;
  }
  thead th {
    background: #f5f5f5;
    padding: .75rem;
    border-bottom: 2px solid #ddd;
    color: #444;
    text-align: left;
  }
  tbody td {
    padding: .65rem .75rem;
    border-bottom: 1px solid #eee;
    color: #555;
  }
  tbody tr:hover { background: #fafafa; }
</style>
{% endblock %}

{% block content %}
<div class="content-card">
  <div class="page-title">إحصائيات المنتجات</div>
  <div class="subtitle">متوسط التقييم وعدد المراجعات (معتمدة / انتظار) لكل منتج</div>

  <div class="stats-summary">
    <div class="item">
      <h3>عدد المنتجات</h3>
      <p>{{ total_products }}</p>
    </div>
    <div class="item">
      <h3>مراجعات معتمدة</h3>
      <p>{{ total_approved }}</p>
    </div>
    <div class="item">
      <h3>مراجعات انتظار</h3>
      <p>{{ total_pending }}</p>
    </div>
  </div>

  <div class="table-container">
    <table>
      <thead>
        <tr>
          <th>المنتج</th>
          <th>متوسط التقييم</th>
          <th>مراجعات معتمدة</th>
          <th>مراجعات انتظار</th>
        </tr>
      </thead>
      <tbody>
        {% for p in products %}
        <tr>
          <td>{{ p.name }}</td>
          <td>{{ p.avg_rating|default:"—"|floatformat:1 }}</td>
          <td>{{ p.approved_count }}</td>
          <td>{{ p.pending_count }}</td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="4" style="text-align:center;color:#777;font-style:italic;">
            لا توجد بيانات لإحصائيات المنتجات.
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
